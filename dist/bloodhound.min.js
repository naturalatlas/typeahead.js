/*!
 * typeahead.js 0.10.5
 * https://github.com/twitter/typeahead.js
 * Copyright 2013-2014 Twitter, Inc. and other contributors; Licensed MIT
 */

!function(a,b){"function"==typeof define&&define.amd?define("bloodhound",["jquery"],function(){return a.returnExportsGlobal=b()}):"object"==typeof exports?module.exports=b(require("jquery")):a.Bloodhound=b(jQuery)}(this,function(){var a=function(){"use strict";return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(a){return!a||/^\s*$/.test(a)},escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(a){return"string"==typeof a},isNumber:function(a){return"number"==typeof a},isArray:$.isArray,isFunction:$.isFunction,isObject:$.isPlainObject,isUndefined:function(a){return"undefined"==typeof a},isElement:function(a){return!(!a||1!==a.nodeType)},isJQuery:function(a){return a instanceof $},toStr:function(b){return a.isUndefined(b)||null===b?"":b+""},bind:$.proxy,each:function(a,b){function c(a,c){return b(c,a)}$.each(a,c)},map:$.map,filter:$.grep,every:function(a,b){var c=!0;return a?($.each(a,function(d,e){return(c=b.call(null,e,d,a))?void 0:!1}),!!c):c},some:function(a,b){var c=!1;return a?($.each(a,function(d,e){return(c=b.call(null,e,d,a))?!1:void 0}),!!c):c},mixin:$.extend,clone:function(a){return $.extend(!0,{},a)},getUniqueId:function(){var a=0;return function(){return a++}}(),templatify:function(a){function b(){return String(a)}return $.isFunction(a)?a:b},defer:function(a){setTimeout(a,0)},debounce:function(a,b,c){var d,e;return function(){var f,g,h=this,i=arguments;return f=function(){d=null,c||(e=a.apply(h,i))},g=c&&!d,clearTimeout(d),d=setTimeout(f,b),g&&(e=a.apply(h,i)),e}},throttle:function(a,b){var c,d,e,f,g,h;return g=0,h=function(){g=new Date,e=null,f=a.apply(c,d)},function(){var i=new Date,j=b-(i-g);return c=this,d=arguments,0>=j?(clearTimeout(e),e=null,g=i,f=a.apply(c,d)):e||(e=setTimeout(h,j)),f}},noop:function(){}}}(),b="0.10.5",c=function(){"use strict";function b(b){return b=a.toStr(b),b?b.split(/\s+/):[]}function c(b){return b=a.toStr(b),b?b.split(/\W+/):[]}function d(b){return function(){var c=[].slice.call(arguments,0);return function(d){var e=[];return a.each(c,function(c){e=e.concat(b(a.toStr(d[c])))}),e}}}return{nonword:c,whitespace:b,obj:{nonword:d(c),whitespace:d(b)}}}(),d=function(){"use strict";function b(b){this.maxSize=a.isNumber(b)?b:100,this.reset(),this.maxSize<=0&&(this.set=this.get=$.noop)}function c(){this.head=this.tail=null}function d(a,b){this.key=a,this.val=b,this.prev=this.next=null}return a.mixin(b.prototype,{set:function(a,b){var c,e=this.list.tail;this.size>=this.maxSize&&(this.list.remove(e),delete this.hash[e.key],this.size--),(c=this.hash[a])?(c.val=b,this.list.moveToFront(c)):(c=new d(a,b),this.list.add(c),this.hash[a]=c,this.size++)},get:function(a){var b=this.hash[a];return b?(this.list.moveToFront(b),b.val):void 0},reset:function(){this.size=0,this.hash={},this.list=new c}}),a.mixin(c.prototype,{add:function(a){this.head&&(a.next=this.head,this.head.prev=a),this.head=a,this.tail=this.tail||a},remove:function(a){a.prev?a.prev.next=a.next:this.head=a.next,a.next?a.next.prev=a.prev:this.tail=a.prev},moveToFront:function(a){this.remove(a),this.add(a)}}),b}(),e=function(){"use strict";function b(b){this.prefix=["__",b,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+a.escapeRegExChars(this.prefix))}function c(){return(new Date).getTime()}function d(b){return JSON.stringify(a.isUndefined(b)?null:b)}function e(a){return $.parseJSON(a)}var f,g;try{f=window.localStorage,f.setItem("~~~","!"),f.removeItem("~~~")}catch(h){f=null}return g=f&&window.JSON?{_prefix:function(a){return this.prefix+a},_ttlKey:function(a){return this._prefix(a)+this.ttlKey},get:function(a){return this.isExpired(a)&&this.remove(a),e(f.getItem(this._prefix(a)))},set:function(b,e,g){return a.isNumber(g)?f.setItem(this._ttlKey(b),d(c()+g)):f.removeItem(this._ttlKey(b)),f.setItem(this._prefix(b),d(e))},remove:function(a){return f.removeItem(this._ttlKey(a)),f.removeItem(this._prefix(a)),this},clear:function(){var a,b,c=[],d=f.length;for(a=0;d>a;a++)(b=f.key(a)).match(this.keyMatcher)&&c.push(b.replace(this.keyMatcher,""));for(a=c.length;a--;)this.remove(c[a]);return this},isExpired:function(b){var d=e(f.getItem(this._ttlKey(b)));return a.isNumber(d)&&c()>d?!0:!1}}:{get:a.noop,set:a.noop,remove:a.noop,clear:a.noop,isExpired:a.noop},a.mixin(b.prototype,g),b}(),f=function(){"use strict";function b(a){a=a||{},this.cancelled=!1,this.lastReq=null,this._send=a.transport?c(a.transport):$.ajax,this._get=a.rateLimiter?a.rateLimiter(this._get):this._get,this._cache=a.cache===!1?new d(0):h}function c(b){return function(c){function d(b){a.defer(function(){f.resolve(b)})}function e(b){a.defer(function(){f.reject(b)})}var f=$.Deferred();return b(c,d,e),f}}var e=0,f={},g=6,h=new d(10);return b.setMaxPendingRequests=function(a){g=a},b.resetCache=function(){h.reset()},a.mixin(b.prototype,{_fingerprint:function(a){return a=a||{},a.url+a.type+$.param(a.data||{})},_get:function(a,b){function c(a){b&&b(null,a),k._cache.set(i,a)}function d(){b&&b(!0)}function h(){e--,delete f[i],k.onDeckRequestArgs&&(k._get.apply(k,k.onDeckRequestArgs),k.onDeckRequestArgs=null)}var i,j,k=this;i=this._fingerprint(a),this.cancelled||i!==this.lastReq||((j=f[i])?j.done(c).fail(d):g>e?(e++,f[i]=this._send(a).done(c).fail(d).always(h)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(b,c){var d,e;return b=a.isString(b)?{url:b}:b||{},e=this._fingerprint(b),this.cancelled=!1,this.lastReq=e,(d=this._cache.get(e))?a.defer(function(){c&&c(null,d)}):this._get(b,c),!!d},cancel:function(){this.cancelled=!0}}),b}(),g=function(){"use strict";function b(a){a=a||{},a.datumTokenizer&&a.queryTokenizer||$.error("datumTokenizer and queryTokenizer are both required"),this.datumTokenizer=a.datumTokenizer,this.queryTokenizer=a.queryTokenizer,this.reset()}function c(b){return b=a.filter(b,function(a){return!!a}),b=a.map(b,function(a){return a.toLowerCase()})}function d(){return{ids:[],children:{}}}function e(a){for(var b={},c=[],d=0,e=a.length;e>d;d++)b[a[d]]||(b[a[d]]=!0,c.push(a[d]));return c}function f(a,b){function c(a,b){return a-b}var d=0,e=0,f=[];a=a.sort(c),b=b.sort(c);for(var g=a.length,h=b.length;g>d&&h>e;)a[d]<b[e]?d++:a[d]>b[e]?e++:(f.push(a[d]),d++,e++);return f}return a.mixin(b.prototype,{bootstrap:function(a){this.datums=a.datums,this.trie=a.trie},add:function(b){var e=this;b=a.isArray(b)?b:[b],a.each(b,function(b){var f,g;f=e.datums.push(b)-1,g=c(e.datumTokenizer(b)),a.each(g,function(a){var b,c,g;for(b=e.trie,c=a.split("");g=c.shift();)b=b.children[g]||(b.children[g]=d()),b.ids.push(f)})})},get:function(b){var d,g,h=this;return d=c(this.queryTokenizer(b)),a.each(d,function(a){var b,c,d,e;if(g&&0===g.length)return!1;for(b=h.trie,c=a.split("");b&&(d=c.shift());)b=b.children[d];return b&&0===c.length?(e=b.ids.slice(0),void(g=g?f(g,e):e)):(g=[],!1)}),g?a.map(e(g),function(a){return h.datums[a]}):[]},all:function(){return this.datums},reset:function(){this.datums=[],this.trie=d()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),b}(),h=function(){"use strict";function c(a){return a.local||null}function d(c){var d,e;return e={url:null,thumbprint:"",ttl:864e5,filter:null,ajax:{}},(d=c.prefetch||null)&&(d=a.isString(d)?{url:d}:d,d=a.mixin(e,d),d.thumbprint=b+d.thumbprint,d.ajax.type=d.ajax.type||"GET",d.ajax.dataType=d.ajax.dataType||"json",!d.url&&$.error("prefetch requires url to be set")),d}function e(b){function c(b){return function(c){return a.debounce(c,b)}}function d(b){return function(c){return a.throttle(c,b)}}var e,f;return f={url:null,cache:!0,under:5,wildcard:"%QUERY",replace:null,rateLimitBy:"debounce",rateLimitWait:300,send:null,filter:null,ajax:{}},(e=b.remote||null)&&(e=a.isString(e)?{url:e}:e,e=a.mixin(f,e),e.rateLimiter=/^throttle$/i.test(e.rateLimitBy)?d(e.rateLimitWait):c(e.rateLimitWait),e.ajax.type=e.ajax.type||"GET",e.ajax.dataType=e.ajax.dataType||"json",delete e.rateLimitBy,delete e.rateLimitWait,!e.url&&$.error("remote requires url to be set")),e}return{local:c,prefetch:d,remote:e}}(),i=function(){"use strict";function b(a){a&&(a.local||a.prefetch||a.remote)||$.error("one of local, prefetch, or remote is required"),this.sorter=d(a.sorter),this.dupDetector=a.dupDetector||i,this.local=h.local(a),this.prefetch=h.prefetch(a),this.remote=h.remote(a),this.cacheKey=this.prefetch?this.prefetch.cacheKey||this.prefetch.url:null,this.index=new g({datumTokenizer:a.datumTokenizer,queryTokenizer:a.queryTokenizer}),this.storage=this.cacheKey?new e(this.cacheKey):null}function d(b){function c(a){return a.sort(b)}function d(a){return a}return a.isFunction(b)?c:d}function i(){return!1}var j,k;return j=window&&window.Bloodhound,k={data:"data",protocol:"protocol",thumbprint:"thumbprint"},b.noConflict=function(){return window&&(window.Bloodhound=j),b},b.tokenizers=c,a.mixin(b.prototype,{__ttAdapter:function(){function a(a,b){return c.get(a,b)}function b(a){return c.get(a)}var c=this;return this.transport?a:b},_loadPrefetch:function(a){function b(b){e.clear(),e.add(a.filter?a.filter(b):b),e._saveToStorage(e.index.serialize(),a.thumbprint,a.ttl)}var c,d,e=this;return(c=this._readFromStorage(a.thumbprint))?(this.index.bootstrap(c),d=$.Deferred().resolve()):d=$.ajax(a.url,a.ajax).done(b),d},_getFromRemote:function(b,c){function d(a,b){c(a?[]:h.remote.filter?h.remote.filter(b):b)}var e,f,g,h=this;if(this.transport&&c)return b=b||"",f=encodeURIComponent(b),g=a.clone(this.remote.ajax),this.remote.before?g=this.remote.before(this.remote.url,b,g):e=this.remote.replace?this.remote.replace(this.remote.url,b):this.remote.url.replace(this.remote.wildcard,f),g.url=e||g.url||this.remote.url,this.transport.get(g,d)},_cancelLastRemoteRequest:function(){this.transport&&this.transport.cancel()},_saveToStorage:function(a,b,c){this.storage&&(this.storage.set(k.data,a,c),this.storage.set(k.protocol,location.protocol,c),this.storage.set(k.thumbprint,b,c))},_readFromStorage:function(a){var b,c={};return this.storage&&(c.data=this.storage.get(k.data),c.protocol=this.storage.get(k.protocol),c.thumbprint=this.storage.get(k.thumbprint)),b=c.thumbprint!==a||c.protocol!==location.protocol,c.data&&!b?c.data:null},_initialize:function(){function b(){d.add(a.isFunction(e)?e():e)}var c,d=this,e=this.local;return c=this.prefetch?this._loadPrefetch(this.prefetch):$.Deferred().resolve(),e&&c.done(b),this.transport=this.remote?new f(this.remote):null,this.initPromise=c.promise()},initialize:function(a){return!this.initPromise||a?this._initialize():this.initPromise},add:function(a){this.index.add(a)},get:function(b,c){function d(b){var d=[];a.each(b,function(b){var c;c=a.some(e,function(a){return f.dupDetector(b,a)}),!c&&d.push(b)}),c&&c(d)}var e,f=this;return e=this.sorter(this.index.get(b)),this.remote?(e.length<this.remote.under?this._getFromRemote(b,d):this._cancelLastRemoteRequest(),e.slice()):e},all:function(){return this.index.all()},clear:function(){this.index.reset()},clearPrefetchCache:function(){this.storage&&this.storage.clear()},clearRemoteCache:function(){this.transport&&f.resetCache()},ttAdapter:function(){return this.__ttAdapter()}}),b}(this);return i});